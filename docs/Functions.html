<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Stacy Irwin" />

<meta name="date" content="2020-01-01" />

<title>Overview of firstapiR Functions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Overview of firstapiR Functions</h1>
<h4 class="author">Stacy Irwin</h4>
<h4 class="date">2020-01-01</h4>



<p>The <a href="http://irwinsnet.github.io/firstapiR/Getting_Started">Getting Started</a> vignette covered how to use the <code>GetSession()</code> function to create a Session object and how to use that Session object in other firstapiR functions. This vignette provides an overview of the remaining firstapiR functions. For detailed information on each function, type <code>help(function_name)</code> at the console or in the RStudio help view search box.</p>
<div id="version-2.0.1" class="section level3">
<h3>Version 2.0.1</h3>
<p>This guide is for version 2.0.1 of the firstapiR package. <a href="http://irwinsnet.github.io/projects/firstapiR/Functions_v100">Guidance for version 1.0.0 of firstapiR is located here</a>.</p>
</div>
<div id="simple-functions-for-retrieving-first-data" class="section level2">
<h2>Simple Functions for Retrieving FIRST Data</h2>
<p>There are several functions that take no arguments other than the <code>Session</code> argument.</p>
<dl>
<dt><code>GetServerStatus(session)</code></dt>
<dd>Retrieves information about the FIRST API server.
</dd>
<dt><code>GetSeason(session)</code></dt>
<dd>Gets information about the season specified in session$season.
</dd>
<dt><code>GetDistricts(session)</code></dt>
<dd>Provides a list of FIRST districts.
</dd>
<dt><code>GetAwardsList(session)</code></dt>
<dd>Obtains a list and description of awards available to FRC teams.
</dd>
</dl>
</div>
<div id="data-retrieval-functions-with-additional-arguments" class="section level2">
<h2>Data Retrieval Functions with Additional Arguments</h2>
<p>All other firstapiR functions take at least a few additional arguments. Most of the additional arguments are optional and, usually, only one or two of the additional arguments are used at any one time.</p>
<dl>
<dt><code>GetEvents(session, event, team, district, exclude_district)</code></dt>
<dd>Provide information about FRC competition events.
</dd>
<dt><code>GetTeams(session, team, event, district, state, page)</code></dt>
<dd>Gets information about FIRST FRC teams.
</dd>
<dt><code>GetSchedule(session, event, level, team, start, end)</code></dt>
<dd>Downloads the match schedule for a specific event.
</dd>
<dt><code>GetHybridSchedule(session, event, level, start, end)</code></dt>
<dd>Downloads the match schedule, along with results for completed matches.
</dd>
<dt><code>GetMatchResults(session, event, level, team, match, start, end)</code></dt>
<dd>Gets the scores for the selected matches.
</dd>
<dt><code>GetScores(session, event, level, team, match, start, end)</code></dt>
<dd>Downloads the scoring sheet for each match.
</dd>
<dt><code>GetAlliances(session, event)</code></dt>
<dd>Obtains the playoff alliances.
</dd>
<dt><code>GetRankings(session, event, team, top)</code></dt>
<dd>Gets the team rankings.
</dd>
<dt><code>GetAwards(session, event, team)</code></dt>
<dd>Lists the awards and recipients for an FRC competition.
</dd>
</dl>
</div>
<div id="function-arguments" class="section level2">
<h2>Function Arguments</h2>
<p>Many of the same arguments are used in several different firstapiR functions.</p>
<div id="team" class="section level3">
<h3>team</h3>
<p>The four digit FRC team number.</p>
</div>
<div id="districts" class="section level3">
<h3>districts</h3>
<p>A code representing a FIRST district. Use GetDistricts() to obtain the district codes that can be used in other firstapiR functions:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(firstapiR)</a>
<a class="sourceLine" id="cb1-2" title="2">sn &lt;-<span class="st"> </span><span class="kw">GetSession</span>(<span class="st">&quot;username&quot;</span>, <span class="st">&quot;key&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">districts &lt;-<span class="st"> </span><span class="kw">GetDistricts</span>(sn)</a></code></pre></div>
</div>
<div id="event" class="section level3">
<h3>event</h3>
<p>An event code, such as <em>WAAMV</em> (disctrict competition held at Auburn MountainView High School in Washington State) or <em>PNCMP</em> (Pacific Northwest District Championships). Use the GetEvents() function to get the event codes:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">sn &lt;-<span class="st"> </span><span class="kw">GetSession</span>(<span class="st">&quot;username&quot;</span>, <span class="st">&quot;key&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">PNW_events &lt;-<span class="st"> </span><span class="kw">GetEvents</span>(sn, <span class="dt">district =</span> <span class="st">&quot;PNW&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">PNW_events[, <span class="kw">c</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;name&quot;</span>)]</a></code></pre></div>
<pre><code>##     code                                                          name
## 1  ORORE  PNW District - Clackamas Academy of Industrial Science Event
## 2  ORPHI                                PNW District - Philomath Event
## 3  ORWIL                              PNW District - Wilsonville Event
## 4  PNCMP Pacific Northwest District Championship sponsored by Autodesk
## 5  WAAHS                                   PNW District - Auburn Event
## 6  WAAMV                      PNW District - Auburn Mountainview Event
## 7  WAELL            PNW District - Central Washington University Event
## 8  WAMOU                             PNW District - Mount Vernon Event
## 9  WASNO                             PNW District - Glacier Peak Event
## 10 WASPO                              PNW District - West Valley Event</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">PNW_events[, <span class="kw">c</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;dateStart&quot;</span>)]</a></code></pre></div>
<pre><code>##     code           dateStart
## 1  ORORE 2016-03-31T00:00:00
## 2  ORPHI 2016-03-24T00:00:00
## 3  ORWIL 2016-03-10T00:00:00
## 4  PNCMP 2016-04-06T00:00:00
## 5  WAAHS 2016-04-01T00:00:00
## 6  WAAMV 2016-03-03T00:00:00
## 7  WAELL 2016-03-17T00:00:00
## 8  WAMOU 2016-03-18T00:00:00
## 9  WASNO 2016-03-11T00:00:00
## 10 WASPO 2016-03-03T00:00:00</code></pre>
</div>
<div id="level" class="section level3">
<h3>level</h3>
<p>Either “playoff” or “qual”. Defaults to “qual”.</p>
</div>
<div id="start-end-match" class="section level3">
<h3>start, end, match</h3>
<p>Integers specifying the range of matches that will be included in the returned data.</p>
</div>
</div>
<div id="pages-argument" class="section level2">
<h2>Pages Argument</h2>
<p>There is one firstapiR function, <code>GetTeams()</code>, that accepts the <code>page</code> argument. When requesting data on FRC teams, the FIRST API will split the results into multiple pages if there are more than 65 teams in the response, requiring a separate HTTP request for each page. Users that are requesting the data frame format can ignore the <code>page</code> argument because <code>GetTeams</code> will automatically detect if there are multiple pages in the response, conduct a separate HTTP request for each page, and merge the results into a single data frame. This feature is not available when XML or JSON formats are sepecifed in the <code>Session$format</code> parameter. Users requesting XML or JSON formatted data will have to call GetTeams() for each page of data, incrementing the <code>page</code> argument for each request.</p>
</div>
<div id="modified-since-arguments" class="section level2">
<h2>Modified-Since Arguments</h2>
<p>There are two additional arguments that can be passed to almost all firstapiR functions (only <code>GetSession()</code> and <code>GetServerStatus()</code> do not accept them). The two arguments, which are always optional, are <code>mod_since</code> and <code>only_mod_since</code>. These two arguments help to reduce the load on the FIRST API server by allowing the server to skip the database query and send only a short HTTP response when the FIRST API server data has not changed since the user last queried the server.</p>
<p>Both of these arguments accept a character vector containing an HTTP formatted date and time string. If the user includes the <code>mod_since</code> argument, and no data has changed on the FIRST API server since the date and time specified in the argument, the FIRST API server will provide an HTTP 304 response with no content. When this happens, irstapiR functions will return a logical character vector with the value <code>NA</code>. Here is an example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Create an HTTP date-time string set to midnight GMT yesterday</span></a>
<a class="sourceLine" id="cb6-2" title="2">mod_date &lt;-<span class="st"> </span>httr<span class="op">::</span><span class="kw">http_date</span>(<span class="kw">as.POSIXct</span>(<span class="kw">Sys.Date</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># Request recently changed data from the server</span></a>
<a class="sourceLine" id="cb6-5" title="5">match_results &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetMatchResults</span>(sn, <span class="dt">event =</span> <span class="st">&quot;PNCMP&quot;</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                                            <span class="dt">mod_since =</span> mod_date)</a>
<a class="sourceLine" id="cb6-7" title="7"></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co"># Assuming there have been no updates to the data since yesterday, this</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#   returns TRUE</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw">is.na</span>(match_results)</a>
<a class="sourceLine" id="cb6-11" title="11"></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co"># The value passed to mod_since returned as an attribute, even when the</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#   result is NA</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="kw">print</span>(<span class="kw">attr</span>(match_results, <span class="st">&quot;mod_since&quot;</span>))</a></code></pre></div>
<p>If the user includes the <code>only_mod_since</code> argument, the FIRST API server will return only the data that has changed since the date and time specified in the <code>only_mod_since</code> argument. In no changes have been made, the FIRST API server provides a 304 response and firstapiR functions return a logical vector set to <code>NA</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Create an HTTP date-time string set to midnight GMT yesterday</span></a>
<a class="sourceLine" id="cb7-2" title="2">mod_date &lt;-<span class="st"> </span>httr<span class="op">::</span><span class="kw">http_date</span>(<span class="kw">as.POSIXct</span>(<span class="kw">Sys.Date</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co"># Request recently changed data from the server</span></a>
<a class="sourceLine" id="cb7-5" title="5">match_results &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetMatchResults</span>(sn, <span class="dt">event =</span> <span class="st">&quot;PNCMP&quot;</span>,</a>
<a class="sourceLine" id="cb7-6" title="6">                                            <span class="dt">only_mod_since =</span> mod_date)</a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co"># Assuming there have been no updates to the data since yesterday, this</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#   returns TRUE</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="kw">is.na</span>(match_results)</a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># The value passed to mod_since returned as an attribute, even when the</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#   result is NA</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="kw">print</span>(<span class="kw">attr</span>(match_results, <span class="st">&quot;only_mod_since&quot;</span>))</a></code></pre></div>
<p>If the <code>mod_since</code> or <code>only_mod_since</code> arguments are not specified, the corresponding <code>mod_since</code> or only_mod_since<code>attribute attached to the return value will be set to</code>NULL`.</p>
<p>Users can keep track of the date and time provided in the <code>last_modified</code> attribute, which corresponds to the most recent date and time that the information changed on the FIRST API server, and use this date and time to request only new data from the server. If a user repeats a firstapiR function call with the same arguments and sets the <code>mod_since</code> or <code>only_mod_since</code> argument to the <code>last_modified</code> attribute value from the intial firstapiR function call, the FIRST API server will return all requested data – the same data that was provided in the first function call. Users who would rather receive a 304 response in this situation should either add at least a second to the <code>last_modified</code> value, or should instead use the <code>time_downloaded</code> attribute value to set the <code>mod_since</code> or <code>only_mod_since</code> arguments.</p>
</div>
<div id="data-frame-shaping-functions" class="section level2">
<h2>Data Frame Shaping Functions</h2>
<div id="team-shape" class="section level3">
<h3>Team Shape</h3>
<p>The functions <code>GetSchedule()</code>, <code>GetHybridSchedule()</code>, and <code>GetMatchResults()</code> return data frames with one row per team. For example, let’s take a look at the first two qualification matches from the 2016 Pacific Northwest District Championships:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sn &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetSession</span>(<span class="st">&quot;username&quot;</span>, <span class="st">&quot;key&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">match_results &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetMatchResults</span>(sn, <span class="st">&quot;PNCMP&quot;</span>, <span class="dt">level =</span> <span class="st">&quot;qual&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">match_results[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">c</span>(<span class="st">&quot;match&quot;</span>, <span class="st">&quot;alliance&quot;</span>, <span class="st">&quot;station&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;scoreAuto&quot;</span>,</a>
<a class="sourceLine" id="cb8-4" title="4">                      <span class="st">&quot;scoreFinal&quot;</span>)]</a></code></pre></div>
<pre><code>##           match alliance station team scoreAuto scoreFinal
## q.1.blue1     1     Blue   Blue1 4915        30        102
## q.1.blue2     1     Blue   Blue2 3674        30        102
## q.1.blue3     1     Blue   Blue3 4125        30        102
## q.1.red1      1      Red    Red1 1318        32        107
## q.1.red2      1      Red    Red2 2907        32        107
## q.1.red3      1      Red    Red3 2944        32        107
## q.2.blue1     2     Blue   Blue1 2374        30        126
## q.2.blue2     2     Blue   Blue2 2557        30        126
## q.2.blue3     2     Blue   Blue3 5920        30        126
## q.2.red1      2      Red    Red1 1595        30        103
## q.2.red2      2      Red    Red2 1425        30        103
## q.2.red3      2      Red    Red3 2147        30        103</code></pre>
<p>There is one team listed in each row, and it takes six rows to provide all of the information from a single match. This is called <em>team</em> shape. This format is useful for calculating summary statistics for individual teams. For example, to see average scores for the ten teams with the highest scores:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">agg_scores &lt;-<span class="st"> </span><span class="kw">aggregate</span>(match_results[<span class="kw">c</span>(<span class="st">&quot;scoreFinal&quot;</span>, <span class="st">&quot;scoreAuto&quot;</span>,</a>
<a class="sourceLine" id="cb10-2" title="2">                                        <span class="st">&quot;scoreFoul&quot;</span>)],</a>
<a class="sourceLine" id="cb10-3" title="3">                        <span class="kw">list</span>(<span class="st">&quot;team&quot;</span> =<span class="st"> </span>match_results<span class="op">$</span>team), mean)</a>
<a class="sourceLine" id="cb10-4" title="4">agg_scores[<span class="kw">order</span>(agg_scores<span class="op">$</span>scoreFinal, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</a></code></pre></div>
<pre><code>##    team scoreFinal scoreAuto scoreFoul
## 12 1983   123.1667  32.16667  4.166667
## 19 2557   121.1667  28.16667  2.916667
## 1   360   118.6667  30.83333  4.166667
## 9  1540   118.1667  27.33333  3.750000
## 46 4131   114.5833  25.41667  4.583333
## 60 5803   114.5000  28.33333  2.500000
## 49 4450   114.2500  28.75000  3.750000
## 6  1318   114.0000  28.50000  3.750000
## 63 5942   112.9167  27.50000  1.666667
## 7  1425   111.7500  24.33333  1.666667</code></pre>
<p>Data frames in team shape will have their <em>shape</em> attribute set to “team”.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">attr</span>(match_results, <span class="st">&quot;shape&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;team&quot;</code></pre>
</div>
<div id="alliance-shape" class="section level3">
<h3>Alliance Shape</h3>
<p>For some calculations, such as offensive power rating (OPR), the alliance shape, with three teams per row and two rows per match (one row each for the red and blue alliances), is more suitable. The function <code>ToAllianceShape()</code> will reshape <em>Schedule</em>, <em>HybridSchedule</em>, or <em>MatchResults</em> data frames from <em>team</em> to <em>alliance</em> shape.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">mresults_alliance &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">ToAllianceShape</span>(match_results)</a>
<a class="sourceLine" id="cb14-2" title="2">mresults_alliance[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">c</span>(<span class="st">&quot;match&quot;</span>, <span class="st">&quot;alliance&quot;</span>, <span class="st">&quot;team.1&quot;</span>, <span class="st">&quot;team.2&quot;</span>, <span class="st">&quot;team.3&quot;</span>,</a>
<a class="sourceLine" id="cb14-3" title="3">                         <span class="st">&quot;scoreAuto&quot;</span>, <span class="st">&quot;scoreFinal&quot;</span>)]</a></code></pre></div>
<pre><code>##        match alliance team.1 team.2 team.3 scoreAuto scoreFinal
## 1.blue     1     Blue   4915   3674   4125        30        102
## 1.red      1      Red   1318   2907   2944        32        107
## 2.blue     2     Blue   2374   2557   5920        30        126
## 2.red      2      Red   1595   1425   2147        30        103</code></pre>
<p>Data frames in alliance shape will have their <em>shape</em> attribute set to “alliance”.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">attr</span>(mresults_alliance, <span class="st">&quot;shape&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;alliance&quot;</code></pre>
</div>
<div id="match-shape" class="section level3">
<h3>Match Shape</h3>
<p>Finally, <em>Schedule</em>, <em>HybridSchedule</em>, and <em>MatchResults</em> data frames may be converted from <em>team</em> to <em>match</em> shape.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">mresults_match &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">ToMatchShape</span>(match_results)</a>
<a class="sourceLine" id="cb18-2" title="2">mresults_match[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="kw">c</span>(<span class="st">&quot;match&quot;</span>, <span class="st">&quot;team.Red1&quot;</span>, <span class="st">&quot;team.Red2&quot;</span>, <span class="st">&quot;team.Red3&quot;</span>,</a>
<a class="sourceLine" id="cb18-3" title="3">                      <span class="st">&quot;team.Blue1&quot;</span>, <span class="st">&quot;team.Blue2&quot;</span>, <span class="st">&quot;team.Blue3&quot;</span>,</a>
<a class="sourceLine" id="cb18-4" title="4">                      <span class="st">&quot;scoreFinal.Blue&quot;</span>, <span class="st">&quot;scoreFinal.Red&quot;</span>)]</a></code></pre></div>
<pre><code>##   match team.Red1 team.Red2 team.Red3 team.Blue1 team.Blue2 team.Blue3
## 1     1      1318      2907      2944       4915       3674       4125
## 2     2      1595      1425      2147       2374       2557       5920
##   scoreFinal.Blue scoreFinal.Red
## 1             102            107
## 2             126            103</code></pre>
</div>
<div id="converting-back-to-team-shape" class="section level3">
<h3>Converting Back to Team Shape</h3>
<p>The <code>ToTeamShape()</code> function will convert <em>match</em> and <em>alliance</em> data frames back to <em>team</em> shape. This function depends on the <em>ReshapeWide</em> attribute, which is added to the <em>match</em> and <em>alliance</em> data frames by R’s <code>reshape()</code> function. <code>ToTeamShape()</code> will not work if the <em>ReshapeWide</em> attribute is deleted.</p>
</div>
<div id="converting-between-match-and-alliance-shape" class="section level3">
<h3>Converting Between Match and Alliance Shape</h3>
<p>To convert a data frame from <em>match</em> to <em>alliance</em> shape or vice-versa, first convert the data frame back to team shape.</p>
</div>
</div>
<div id="saving-and-loading-data" class="section level2">
<h2>Saving and Loading Data</h2>
<p>Use firstapiR’s <code>SaveData()</code> function to open a save file dialog box and save data to an RDS data file. The <code>ReadData()</code> function opens an open file dialog and returns the value saved in the RDS file. Refer to R’s documentation on the <code>saveRDS()</code> and `readRDS()’ functions for more information on RDS data files.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">SaveData</span>(firstapiR<span class="op">::</span><span class="kw">GetAlliances</span>(sn, <span class="dt">event =</span> <span class="st">&quot;WAAMV&quot;</span>))</a>
<a class="sourceLine" id="cb20-2" title="2">evt_alliances &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">ReadData</span>()</a></code></pre></div>
</div>
<div id="getting-all-event-data" class="section level2">
<h2>Getting all Event Data</h2>
<p>Sometimes it’s handy to get all the available information for an FRC competition with single command. The <code>GetAll()</code> function retrieves all data for a specific event and stores the data in a list. I recommend <strong>not</strong> using this function during competitions to avoid overloading the server. Also, save the event data to a file so it only needs to be downloaded once.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Get all data for the 2016 district competition at Auburn Mountainview HS</span></a>
<a class="sourceLine" id="cb21-2" title="2">sn &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetSession</span>(<span class="st">&quot;username&quot;</span>, <span class="st">&quot;key&quot;</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">all_data &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">GetAll</span>(sn, <span class="dt">event =</span> <span class="st">&quot;WAAMV&quot;</span>)</a></code></pre></div>
</div>
<div id="preloaded-data" class="section level2">
<h2>Preloaded Data</h2>
<p>Version 2.0.1 of firstapiR includes all competition data for the 2016 FRC championships in St. Louis. Data for each subdivision and the finals are available in R lists named <code>archimedes2016</code>, <code>carson2016</code>, <code>carver2016</code>, <code>curie2016</code>, <code>galileo2016</code>, <code>hopper2016</code>, <code>newton2016</code>, <code>tesla2016</code>, and <code>einstein2016</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># Show elements in curie2016 list:</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">names</span>(firstapiR<span class="op">::</span>curie2016)</a></code></pre></div>
<pre><code>##  [1] &quot;season&quot;           &quot;event&quot;            &quot;teams&quot;            &quot;schedule.qual&quot;   
##  [5] &quot;schedule.playoff&quot; &quot;hybrid.qual&quot;      &quot;hybrid.playoff&quot;   &quot;matches.qual&quot;    
##  [9] &quot;matches.playoff&quot;  &quot;scores.qual&quot;      &quot;scores.playoff&quot;   &quot;results.qual&quot;    
## [13] &quot;results.playoff&quot;  &quot;rankings&quot;         &quot;alliances&quot;        &quot;awards&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># Show alliances for Curie Subdivision (first 8 columns)</span></a>
<a class="sourceLine" id="cb24-2" title="2">firstapiR<span class="op">::</span>curie2016<span class="op">$</span>alliances[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</a></code></pre></div>
<pre><code>##   number       name captain round1 round2 round3 backup backupReplaced
## 1      1 Alliance 1    3546    166    858   3618     NA             NA
## 2      2 Alliance 2    1089   1983   4469    836     NA             NA
## 3      3 Alliance 3      25   2848   4329   1885     NA             NA
## 4      4 Alliance 4    5803   3310   2168   5940     NA             NA
## 5      5 Alliance 5    5406   3641   1261   2883     NA             NA
## 6      6 Alliance 6     639   3990   1662    287     NA             NA
## 7      7 Alliance 7    3005    876   2557   4061     NA             NA
## 8      8 Alliance 8     694   3339    379   1511     NA             NA</code></pre>
</div>
<div id="merging-team-and-score-data" class="section level2">
<h2>Merging Team and Score Data</h2>
<p>The <code>GetScores()</code> function retrieves detailed performance data for for both the red and blue alliances for each match. However the <em>Scores</em> data frame does not list the teams that were assigned to each alliance. The function <code>MergeResults()</code> merges a <em>HybridResults</em> data frame with a <em>Scores</em> data frame to create a <em>Results</em> data frame that contains both the detailed match performance data and the teams that were assigned to each match.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Merge MatchResults and Scores data frames</span></a>
<a class="sourceLine" id="cb26-2" title="2">curie_results &lt;-<span class="st"> </span>firstapiR<span class="op">::</span><span class="kw">MergeResults</span>(firstapiR<span class="op">::</span>curie2016<span class="op">$</span>hybrid.qual,</a>
<a class="sourceLine" id="cb26-3" title="3">                                         firstapiR<span class="op">::</span>curie2016<span class="op">$</span>scores.qual)</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co"># Show structure of resulting data frame</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">str</span>(curie_results)</a></code></pre></div>
<pre><code>## Classes &#39;Results&#39; and &#39;data.frame&#39;:  750 obs. of  49 variables:
##  $ match                 : int  1 1 1 1 1 1 2 2 2 2 ...
##  $ level                 : Factor w/ 1 level &quot;Qualification&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ alliance              : Factor w/ 2 levels &quot;Blue&quot;,&quot;Red&quot;: 1 1 1 2 2 2 1 1 1 2 ...
##  $ description           : chr  &quot;Qualification 1 (B)&quot; &quot;Qualification 1 (B)&quot; &quot;Qualification 1 (B)&quot; &quot;Qualification 1 (B)&quot; ...
##  $ start                 : chr  &quot;2016-04-28T08:30:00&quot; &quot;2016-04-28T08:30:00&quot; &quot;2016-04-28T08:30:00&quot; &quot;2016-04-28T08:30:00&quot; ...
##  $ actualStart           : chr  &quot;2016-04-28T08:31:22.123&quot; &quot;2016-04-28T08:31:22.123&quot; &quot;2016-04-28T08:31:22.123&quot; &quot;2016-04-28T08:31:22.123&quot; ...
##  $ team                  : Factor w/ 75 levels &quot;8&quot;,&quot;25&quot;,&quot;166&quot;,..: 34 6 12 29 74 54 7 65 45 8 ...
##  $ station               : Factor w/ 6 levels &quot;Blue1&quot;,&quot;Blue2&quot;,..: 1 2 3 4 5 6 1 2 3 4 ...
##  $ surrogate             : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ disqualified          : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ AudienceGroup         : Factor w/ 4 levels &quot;GroupA&quot;,&quot;GroupB&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ robot1Auto            : Factor w/ 3 levels &quot;Crossed&quot;,&quot;None&quot;,..: 1 1 1 3 3 3 1 1 1 3 ...
##  $ robot2Auto            : Factor w/ 3 levels &quot;Crossed&quot;,&quot;None&quot;,..: 3 3 3 1 1 1 1 1 1 3 ...
##  $ robot3Auto            : Factor w/ 3 levels &quot;Crossed&quot;,&quot;None&quot;,..: 1 1 1 3 3 3 1 1 1 1 ...
##  $ autoBouldersLow       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ autoBouldersHigh      : int  1 1 1 0 0 0 0 0 0 1 ...
##  $ teleopBouldersLow     : int  6 6 6 6 6 6 5 5 5 4 ...
##  $ teleopBouldersHigh    : int  4 4 4 0 0 0 12 12 12 1 ...
##  $ towerFaceA            : Factor w/ 4 levels &quot;Challenged&quot;,&quot;None&quot;,..: 1 1 1 2 2 2 1 1 1 1 ...
##  $ towerFaceB            : Factor w/ 4 levels &quot;Challenged&quot;,&quot;None&quot;,..: 1 1 1 4 4 4 3 3 3 3 ...
##  $ towerFaceC            : Factor w/ 4 levels &quot;Challenged&quot;,&quot;None&quot;,..: 1 1 1 4 4 4 2 2 2 1 ...
##  $ towerEndStrength      : int  5 5 5 -1 -1 -1 4 4 4 -6 ...
##  $ teleopTowerCaptured   : logi  TRUE TRUE TRUE FALSE FALSE FALSE ...
##  $ teleopDefensesBreached: logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
##  $ position1crossings    : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ position2             : Factor w/ 7 levels &quot;A_ChevalDeFrise&quot;,..: 6 6 6 1 1 1 6 6 6 6 ...
##  $ position2crossings    : int  2 2 2 1 1 1 2 2 2 2 ...
##  $ position3             : Factor w/ 5 levels &quot;A_ChevalDeFrise&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ position3crossings    : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ position4             : Factor w/ 8 levels &quot;A_ChevalDeFrise&quot;,..: 7 7 7 6 6 6 7 7 7 1 ...
##  $ position4crossings    : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ position5             : Factor w/ 8 levels &quot;A_ChevalDeFrise&quot;,..: 1 1 1 7 7 7 1 1 1 7 ...
##  $ position5crossings    : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ foulCount             : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ techFoulCount         : int  0 0 0 1 1 1 1 1 1 0 ...
##  $ autoPoints            : int  32 32 32 14 14 14 30 30 30 24 ...
##  $ autoReachPoints       : int  2 2 2 4 4 4 0 0 0 4 ...
##  $ autoCrossingPoints    : int  20 20 20 10 10 10 30 30 30 10 ...
##  $ autoBoulderPoints     : int  10 10 10 0 0 0 0 0 0 10 ...
##  $ teleopPoints          : int  87 87 87 52 52 52 125 125 125 83 ...
##  $ teleopCrossingPoints  : int  40 40 40 40 40 40 35 35 35 45 ...
##  $ teleopBoulderPoints   : int  32 32 32 12 12 12 70 70 70 13 ...
##  $ teleopChallengePoints : int  15 15 15 0 0 0 5 5 5 10 ...
##  $ teleopScalePoints     : int  0 0 0 0 0 0 15 15 15 15 ...
##  $ breachPoints          : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ capturePoints         : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ adjustPoints          : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ foulPoints            : int  5 5 5 0 0 0 0 0 0 5 ...
##  $ totalPoints           : int  124 124 124 66 66 66 155 155 155 112 ...
##  - attr(*, &quot;url&quot;)= chr  &quot;https://frc-api.firstinspires.org/v2.0/2016/schedule/CURIE/qual/hybrid&quot; &quot;https://frc-api.firstinspires.org/v2.0/2016/scores/CURIE/qual&quot;</code></pre>
<p>Actually, using <code>MergeResults()</code> is not necessary for preloaded data (such as <code>curie2016</code> or for any data structures created with the <code>GetAll()</code> function. These lists already contain merged data frames – see <code>curie2016$results.qual</code> and <code>curie2016$results.playoff</code> for examples. I used the preloaded data to demonstrate the <code>MergeResults()</code> function because that’s an easy way to do it.</p>
</div>
<div id="merging-qualification-and-playoff-data-frames" class="section level2">
<h2>Merging Qualification and Playoff Data Frames</h2>
<p>There are several functions provide data for either qualification or playoff matches, but not both. Use R’s <code>rbind()</code> function to merge this data into a single data frame.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># Number qualification matches</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">nrow</span>(firstapiR<span class="op">::</span>curie2016<span class="op">$</span>matches.qual)</a></code></pre></div>
<pre><code>## [1] 750</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># Number playoff matches</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">nrow</span>(firstapiR<span class="op">::</span>curie2016<span class="op">$</span>matches.playoff)</a></code></pre></div>
<pre><code>## [1] 102</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># Merge qualification and playoff data into a single table</span></a>
<a class="sourceLine" id="cb32-2" title="2">all_matches &lt;-<span class="st"> </span><span class="kw">rbind</span>(firstapiR<span class="op">::</span>curie2016<span class="op">$</span>matches.qual,</a>
<a class="sourceLine" id="cb32-3" title="3">                     firstapiR<span class="op">::</span>curie2016<span class="op">$</span>matches.playoff)</a>
<a class="sourceLine" id="cb32-4" title="4"></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="co"># Total Matches</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="kw">nrow</span>(all_matches)</a></code></pre></div>
<pre><code>## [1] 852</code></pre>
</div>
<div id="ask-questions" class="section level2">
<h2>Ask Questions</h2>
<p>Post an issue on the <a href="https://github.com/irwinsnet/firstapiR">firstapiR github repository</a> if you have questions, find bugs or have recommendations for the next version.</p>
</div>
<div id="links" class="section level2">
<h2>Links</h2>
<p><a href="http://irwinsnet.github.io/firstapiR/Getting_Started">Getting Started Guide</a></p>
<p><a href="http://irwinsnet.github.io">Irwinsnet Home Page</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
